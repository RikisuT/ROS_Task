<launch>
  <let name="world_file"
       value="$(find-pkg-share x500_gazebo)/worlds/default.sdf" />
  <let name="urdf_file"
       value="$(find-pkg-share x500_description)/models/x500/model.sdf.xacro" />
  <let name="config_file"
       value="$(find-pkg-share x500_bringup)/config/x500_bridge.yaml" />
  <let name="robot_description" 
       value="$(command 'xacro $(var urdf_file)')" />
       
  <include file="$(find-pkg-share ros_gz_sim)/launch/gz_sim.launch.py">
    <arg name="gz_args" value="$(var world_file)" />
  </include>

  <include file="$(find-pkg-share ros_gz_sim)/launch/ros_gz_spawn_model.launch.py">
    <arg name="bridge_name" value="ros_gz_bridge" />
    <arg name="world" value="default" />
    <arg name="config_file" value="$(var config_file)" />
    <arg name="model_string" value="$(var robot_description)" />
    <arg name="x" value="0.0" />
    <arg name="y" value="0.0" />
    <arg name="z" value="0.23" />
  </include>

  <node pkg="robot_state_publisher" exec="robot_state_publisher" output="both">
    <param name="use_sim_time" value="true" />
    <param name="robot_description" value="$(var robot_description)" />
  </node>

  <node pkg="rviz2" exec="rviz2"
        args="-d $(find-pkg-share x500_bringup)/config/x500.rviz" />
  
</launch>